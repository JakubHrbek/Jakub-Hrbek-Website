<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Insertion Sort | Algolt</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet" />
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/prism.min.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism.css" />
  <link rel="stylesheet" href="algorithm.css" />
</head>
<body>
  <nav class="navbar sticky top-0 z-50">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between items-center h-16">
        <div class="flex items-center space-x-8">
          <a href="../index.html" class="navbar-link text-sm font-medium text-gray-900 hover:text-blue-600">JH</a>
          <a href="../../algolt/index.html" class="navbar-link far-link text-sm font-medium text-gray-900 hover:text-blue-600">Home</a>
        </div>
        <div class="flex items-center">
          <span class="text-sm font-medium text-gray-600">Insertion Sort</span>
        </div>
      </div>
    </div>
  </nav>

  <header class="px-4 md:px-6 py-12 border-b border-gray-200 bg-white">
    <div class="max-w-7xl mx-auto">
      <h1 class="text-3xl md:text-4xl font-bold text-gray-900 mb-3">
        Insertion Sort Visualizer
      </h1>
      <p class="text-lg text-gray-600 max-w-2xl">
        Interactive visualization of the insertion sort algorithm with step-by-step execution and performance metrics.
      </p>
    </div>
  </header>

  <main class="max-w-7xl mx-auto p-4 md:p-6 space-y-12">
    <section class="grid grid-cols-1 lg:grid-cols-3 gap-8">
      <div class="lg:col-span-2 space-y-6">
        <div class="visualizer-card card p-6">
          <div id="visualizer" class="flex items-end justify-center h-[280px] md:h-[320px] overflow-hidden"></div>
        </div>
        
        <div class="card p-6">
          <div class="control-buttons flex flex-wrap gap-3 mb-6">
            <button id="playBtn" class="btn btn-primary px-6 py-3">Play</button>
            <button id="pauseBtn" class="btn btn-primary px-6 py-3">Pause</button>
            <button id="stepBtn" class="btn btn-primary px-6 py-3">Step</button>
            <button id="resetBtn" class="btn btn-secondary px-6 py-3">Reset</button>
          </div>
          
          <div class="stats-grid">
            <div class="stat-item">
              <div class="stat-label">Timer</div>
              <div id="timer" class="stat-value mono">0.00s</div>
            </div>
            <div class="stat-item">
              <div class="stat-label">Comparisons</div>
              <div id="comparisons" class="stat-value mono">0</div>
            </div>
            <div class="stat-item">
              <div class="stat-label">Shifts</div>
              <div id="shifts" class="stat-value mono">0</div>
            </div>
            <div class="stat-item">
              <div class="stat-label">Position</div>
              <div id="position" class="stat-value mono">0</div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="lg:col-span-1">
        <div class="code-block h-full">
          <pre><code class="language-js">function insertionSort(arr) {
  const n = arr.length;
  
  for (let i = 1; i < n; i++) {
    let key = arr[i];
    let j = i - 1;
    
    while (j >= 0 && arr[j] > key) {
      arr[j + 1] = arr[j];
      j--;
    }
    
    arr[j + 1] = key;
  }
  
  return arr;
}</code></pre>
        </div>
      </div>
    </section>

    <section class="card p-6">
      <h2 class="section-title">Custom Input</h2>
      <p class="text-gray-600 mb-4">Enter your own array of numbers to visualize the sorting process.</p>
      <div class="flex flex-col sm:flex-row gap-3">
        <div class="input-group flex-1">
          <input id="customInput" class="input-field" placeholder="Enter comma-separated numbers (e.g. 64,34,25,12,22,11,90)" />
        </div>
        <button id="loadCustom" class="btn btn-primary px-6 py-3 whitespace-nowrap">Load Array</button>
      </div>
    </section>

    <section class="grid grid-cols-1 md:grid-cols-2 gap-8">
      <div class="card p-6">
        <h2 class="section-title">How It Works</h2>
        <p class="text-gray-700 leading-relaxed">
          Insertion Sort builds the sorted array one element at a time by taking each element from the unsorted portion and inserting it into its correct position in the sorted portion, similar to how you might sort playing cards in your hand.
        </p>
      </div>
      
      <div class="card p-6">
        <h2 class="section-title">Key Characteristics</h2>
        <ul class="space-y-2 text-gray-700">
          <li class="flex items-start">
            <span class="text-blue-600 mr-2">•</span>
            <span><strong>Stable:</strong> Equal elements maintain relative order</span>
          </li>
          <li class="flex items-start">
            <span class="text-blue-600 mr-2">•</span>
            <span><strong>In-place:</strong> Sorts with O(1) extra space</span>
          </li>
          <li class="flex items-start">
            <span class="text-blue-600 mr-2">•</span>
            <span><strong>Adaptive:</strong> Efficient for small or nearly sorted data</span>
          </li>
          <li class="flex items-start">
            <span class="text-blue-600 mr-2">•</span>
            <span><strong>Online:</strong> Can sort a list as it receives it</span>
          </li>
        </ul>
      </div>
    </section>
    
    <section class="card p-6">
      <h2 class="section-title">Time & Space Complexity</h2>
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
        <div>
          <h3 class="text-lg font-semibold mb-4 text-gray-800">Insertion Sort Analysis</h3>
          <div class="space-y-3">
            <div class="flex justify-between items-center py-2 border-b border-gray-100">
              <span class="font-medium text-gray-700">Best Case:</span>
              <span class="mono text-green-600 font-semibold">O(n)</span>
            </div>
            <div class="flex justify-between items-center py-2 border-b border-gray-100">
              <span class="font-medium text-gray-700">Average Case:</span>
              <span class="mono text-yellow-600 font-semibold">O(n²)</span>
            </div>
            <div class="flex justify-between items-center py-2 border-b border-gray-100">
              <span class="font-medium text-gray-700">Worst Case:</span>
              <span class="mono text-red-600 font-semibold">O(n²)</span>
            </div>
            <div class="flex justify-between items-center py-2">
              <span class="font-medium text-gray-700">Space:</span>
              <span class="mono text-blue-600 font-semibold">O(1)</span>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="quiz-card" id="quiz-section">
      <h2 class="section-title">Test Your Knowledge</h2>
      <div id="quiz-container"></div>
    </section>

    <section class="card p-6 text-center">
      <a href="./selection-sort.html" class="inline-flex items-center text-blue-600 hover:text-blue-700 font-medium transition-colors">
        Next: Selection Sort 
        <svg class="ml-2 w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
        </svg>
      </a>
    </section>
  </main>

  <script src="quiz.js"></script>
  
  <script>
    const visualizer = document.getElementById("visualizer");
    const playBtn = document.getElementById("playBtn");
    const pauseBtn = document.getElementById("pauseBtn");
    const stepBtn = document.getElementById("stepBtn");
    const resetBtn = document.getElementById("resetBtn");
    const loadCustom = document.getElementById("loadCustom");
    const input = document.getElementById("customInput");
    const timerDisplay = document.getElementById("timer");
    const comparisonsDisplay = document.getElementById("comparisons");
    const shiftsDisplay = document.getElementById("shifts");
    const positionDisplay = document.getElementById("position");

    let values = [], bars = [], i = 1, j = 0, key = 0, comparisons = 0, shifts = 0;
    let isPlaying = false, isPaused = false, isComplete = false;
    let startTime, elapsedTime = 0, timerInterval;

    function updateStats() {
      comparisonsDisplay.innerText = comparisons;
      shiftsDisplay.innerText = shifts;
      positionDisplay.innerText = i;
    }

    function getOptimalArraySize() {
      const isMobile = window.innerWidth <= 768;
      return isMobile ? 18 : 25;
    }

    function generateBars(custom = null) {
      const arraySize = getOptimalArraySize();
      values = custom || Array.from({ length: arraySize }, () => Math.floor(Math.random() * 90) + 10);
      
      if (window.innerWidth <= 768 && values.length > 18) {
        values = values.slice(0, 18);
      }
      
      visualizer.innerHTML = "";
      bars = values.map(value => {
        const bar = document.createElement("div");
        bar.classList.add("bar");
        const maxHeight = window.innerWidth <= 768 ? 220 : 260;
        const height = Math.min((value / 100) * maxHeight, maxHeight);
        bar.style.height = `${height}px`;
        visualizer.appendChild(bar);
        return bar;
      });
      
      i = 1; j = 0; key = 0; comparisons = 0; shifts = 0; elapsedTime = 0; isComplete = false;
      timerDisplay.innerText = "0.00s";
      updateStats();
      
      if (bars.length > 0) {
        bars[0].classList.add('sorted');
      }
      
      playBtn.disabled = false;
      playBtn.textContent = "Play";
      pauseBtn.textContent = "Pause";
      isPaused = false;
      isPlaying = false;
    }

    function startTimer() {
      startTime = Date.now() - elapsedTime * 1000;
      clearInterval(timerInterval);
      timerInterval = setInterval(() => {
        if (!isPaused) {
          elapsedTime = (Date.now() - startTime) / 1000;
          timerDisplay.innerText = `${elapsedTime.toFixed(2)}s`;
        }
      }, 10);
    }

    function resetBarColors() {
      bars.forEach((bar, index) => {
        bar.classList.remove('comparing', 'current-key');
        if (index < i) {
          bar.classList.add('sorted');
        } else {
          bar.classList.remove('sorted');
        }
      });
    }

    async function sortStep() {
      if (i >= values.length) {
        isComplete = true;
        clearInterval(timerInterval);
        bars.forEach(bar => bar.classList.add('sorted'));
        playBtn.textContent = "Complete";
        playBtn.disabled = true;
        return;
      }

      if (j === i - 1) {
        key = values[i];
        resetBarColors();
        bars[i].classList.add('current-key');
        j = i - 1;
      }

      if (j >= 0) {
        comparisons++;
        bars[j].classList.add('comparing');
        
        if (values[j] > key) {
          shifts++;
          values[j + 1] = values[j];
          const maxHeight = window.innerWidth <= 768 ? 220 : 260;
          bars[j + 1].style.height = `${Math.min((values[j + 1] / 100) * maxHeight, maxHeight)}px`;
          bars[j + 1].classList.remove('current-key');
          j--;
        } else {
          values[j + 1] = key;
          const maxHeight = window.innerWidth <= 768 ? 220 : 260;
          bars[j + 1].style.height = `${Math.min((key / 100) * maxHeight, maxHeight)}px`;
          bars[j + 1].classList.remove('current-key');
          bars[j + 1].classList.add('sorted');
          
          i++;
          j = i - 1;
        }
      } else {
        values[0] = key;
        const maxHeight = window.innerWidth <= 768 ? 220 : 260;
        bars[0].style.height = `${Math.min((key / 100) * maxHeight, maxHeight)}px`;
        bars[0].classList.remove('current-key');
        bars[0].classList.add('sorted');
        
        i++;
        j = i - 1;
      }

      const delay = window.innerWidth <= 768 ? 300 : 200;
      await new Promise(r => setTimeout(r, delay));
      
      bars.forEach(bar => bar.classList.remove('comparing'));
      
      updateStats();
    }

    async function insertionSortLoop() {
      startTimer();
      while (i < values.length && isPlaying && !isPaused && !isComplete) {
        await sortStep();
      }
      if (isComplete) {
        clearInterval(timerInterval);
      }
    }

    playBtn.onclick = () => {
      if (!isPlaying && !isComplete) {
        isPlaying = true;
        isPaused = false;
        playBtn.textContent = "Playing...";
        insertionSortLoop();
      }
    };

    pauseBtn.onclick = () => {
      if (isComplete) return;
      
      isPaused = !isPaused;
      if (!isPaused && isPlaying) {
        insertionSortLoop();
        pauseBtn.textContent = "Pause";
        playBtn.textContent = "Playing...";
      } else {
        pauseBtn.textContent = "Resume";
        playBtn.textContent = "Play";
      }
    };

    stepBtn.onclick = async () => {
      if (!isComplete) {
        isPlaying = false;
        isPaused = true;
        playBtn.textContent = "Play";
        pauseBtn.textContent = "Pause";
        await sortStep();
      }
    };

    resetBtn.onclick = () => {
      isPaused = true;
      isPlaying = false;
      isComplete = false;
      clearInterval(timerInterval);
      generateBars();
    };

    loadCustom.onclick = () => {
      const nums = input.value.split(',')
        .map(n => parseInt(n.trim()))
        .filter(n => !isNaN(n) && n > 0)
        .map(n => Math.min(n, 100));
      
      if (nums.length > 1) {
        const maxSize = window.innerWidth <= 768 ? 18 : 35;
        const limitedNums = nums.slice(0, maxSize);
        generateBars(limitedNums);
        input.value = '';
      } else {
        alert('Please enter at least 2 valid numbers separated by commas.');
      }
    };

    window.addEventListener('resize', () => {
      generateBars(values);
    });

    input.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') {
        loadCustom.click();
      }
    });

    generateBars();

    const insertionSortQuizData = [
      {
        question: "What is the best-case time complexity of Insertion Sort?",
        options: ["O(n²)", "O(n log n)", "O(n)", "O(log n)"],
        answer: "O(n)",
        explanation: "Best case occurs when the array is already sorted, requiring only n-1 comparisons with no shifts."
      },
      {
        question: "What makes Insertion Sort particularly efficient for small datasets?",
        options: [
          "It has constant space complexity",
          "It has low overhead and is adaptive", 
          "It never makes unnecessary comparisons",
          "It always runs in linear time"
        ],
        answer: "It has low overhead and is adaptive",
        explanation: "Insertion Sort has simple implementation with low constant factors and performs well on small or nearly sorted arrays."
      },
      {
        question: "In which scenario does Insertion Sort perform best?",
        options: [
          "When the array is reverse sorted",
          "When the array is already sorted",
          "When the array has many duplicates",
          "When the array is randomly ordered"
        ],
        answer: "When the array is already sorted",
        explanation: "Best case occurs when the array is already sorted, requiring only one comparison per element with no shifts."
      },
      {
        question: "What is the main operation in Insertion Sort?",
        options: [
          "Swapping adjacent elements",
          "Finding the minimum element",
          "Inserting elements into correct position",
          "Partitioning the array"
        ],
        answer: "Inserting elements into correct position",
        explanation: "Insertion Sort works by taking each element and inserting it into its correct position in the already sorted portion of the array."
      }
    ];

    AlgorithmQuiz.create('quiz-container', insertionSortQuizData);
  </script>
</body>
</html>